!function($){function toIntegersAtLease(e){return 10>e?"0"+e:e}Date.prototype.toJSON=function(){return this.getUTCFullYear()+"-"+toIntegersAtLease(this.getUTCMonth())+"-"+toIntegersAtLease(this.getUTCDate())};var escapeable=/["\\\x00-\x1f\x7f-\x9f]/g,meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};$.quoteString=function(e){return'"'+e.replace(escapeable,function(e){var o=meta[e];return"string"==typeof o?o:(o=e.charCodeAt(),"\\u00"+Math.floor(o/16).toString(16)+(o%16).toString(16))})+'"'},$.toJSON=function(e,o){var a=typeof e;if("undefined"==a)return"undefined";if("number"==a||"boolean"==a)return e+"";if(null===e)return"null";if("string"==a){var n=$.quoteString(e);return n}if("object"==a&&"function"==typeof e.toJSON)return e.toJSON(o);if("function"!=a&&"number"==typeof e.length){for(var t=[],r=0;r<e.length;r++)t.push($.toJSON(e[r],o));return o?"["+t.join(",")+"]":"["+t.join(", ")+"]"}if("function"==a)throw new TypeError("Unable to convert object of type 'function' to json.");var t=[];for(var i in e){var l;if(a=typeof i,"number"==a)l='"'+i+'"';else{if("string"!=a)continue;l=$.quoteString(i)}var s=$.toJSON(e[i],o);"string"==typeof s&&(o?t.push(l+":"+s):t.push(l+": "+s))}return"{"+t.join(", ")+"}"},$.compactJSON=function(e){return $.toJSON(e,!0)},$.evalJSON=function(src){return eval("("+src+")")},$.secureEvalJSON=function(src){var filtered=src;if(filtered=filtered.replace(/\\["\\\/bfnrtu]/g,"@"),filtered=filtered.replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]"),filtered=filtered.replace(/(?:^|:|,)(?:\s*\[)+/g,""),/^[\],:{}\s]*$/.test(filtered))return eval("("+src+")");throw new SyntaxError("Error parsing JSON, source is not valid.")}}(jQuery),jQuery(document).ready(function(e){"use strict";var o={init:function(){e(".noo-plupload").each(function(){var o=e(this);o.on("click","a.delete-pluploaded",function(a){if(a.preventDefault(),confirm(nooPluploadL10n.confirmMsg)){var n=e(this),t={filename:n.data("filename"),nonce:nooPluploadL10n.remove,action:"noo_plupload_delete_file"},r=n.parent().index();e.post(nooPluploadL10n.ajaxurl,t,function(){n.parent().remove();var a=o.find(".noo-plupload-value"),t=a.val();t=e.secureEvalJSON(t),t.splice(r,1),a.val(e.toJSON(t))})}}),"undefined"!=typeof plupload&&(o.find(".noo-plupload-btn").each(function(){var a=new plupload.Uploader(e(this).data("settings"));a.init(),a.bind("FilesAdded",function(n,t){e.each(t,function(e,a){o.find(".noo-plupload-preview").html('<div id="'+a.id+'">'+a.name+" ("+plupload.formatSize(a.size)+") <b></b></div>")}),n.refresh(),a.start()}),a.bind("UploadProgress",function(o,a){e("#"+a.id+" b").html(a.percent+"%")}),a.bind("Error",function(e,a){o.find(".noo-plupload-preview").html("<div>Error: "+a.code+", Message: "+a.message+(a.file?", File: "+a.file.name:"")+"</div>"),e.refresh()}),a.bind("FileUploaded",function(a,n,t){var r=e.secureEvalJSON(t.response);if("error"==r.status)return void o.find(".noo-plupload-preview").prepend(r.error.message);var i="<strong>"+r.data.filename+"</strong>";if(i="<a class='delete-pluploaded' data-filename='"+r.data.filename+"' href='#' title='Delete File'><i class='fa fa-trash-o' style='color:#f00'></i></a> "+i,e("#"+n.id).html(i),100==n.percent&&r.status&&"ok"==r.status){var l=o.find(".noo-plupload-value"),s=l.val();s=""===s?[]:e.parseJSON(s),s.push(r.data.filename),l.val(e.toJSON(s))}})}),o.on("click",".noo-plupload-btn .plupload-btn",function(e){uploader.start(),e.preventDefault()}))})}};o.init()});
